= Introduction =

SnakeOS v1.0 source code.

SNAKE firmware for Str8132-Based NAS

Licence GNU GPL.
Owner Douglas Gazineu

= Details =

SNAKE firmware for Str8132-Based NAS

Release info:

    Version 1.0.0
What's new:
    - IMPROVEMENTS

  *If you need a compiled version ready for firmware upgrade - use download section or use this link:*

http://groups.google.com/group/dealextreme-nas-/web/snake-os---v1-0-0


    NEW: Added Busybox "split" command
Changed firmware checking scheme. Does not have the need to generate "optimized" firmwares anymore, altough SnakeOS accepts both types when updating. This version will be last to have a "from-snake" variant.
    NEW: Added Busybox telnetd service
    NEW: Added SecureFTP Service (OpenSSH 5.2p1 sftp-server). By default, only root user can access thru sftp. In order to open sftp access to ordinary users, it is needed to change file /etc/passwd (/bin/nologin -> /bin/sh). Please keep in mind that this will open access to telnet and ssh for those users too.)
    NEW: Added secondary Web Server (based on BusyBox httpd). On later versions it will be changed to another more flexible daemon.
    NEW: Added rsync 3.0.6 - To work out on an incremental backup service for the NAS.
    Transmission: Service control enhanced to avoid reported problems on stopping/restarting
    Added a symlink for ".ssh" inside /root, pointing towards /etc/ssh. This will enable to keep ssh keys and save with config. Hint: To generate the public root key and export to a file, use "dropbearkey -y -f /etc/dropbear/dropbear_rsa_host_key | grep ^ssh-rsa > /root/.ssh/rsa.pub". Usefull to play with rsync.
    - BUG FIXES

    Transmission: Fix for checkboxes "Wed" & "Fry". Fix for combo box: "Alt Time End"
    Timezone: Fixed timezone settings for "Asia/Calcutta", now correctly adjusts to "GMT +5.5"
    DDNS: Startup properly inserted into rc.sysinit
    Firmware Update: Gracefully umount external disks on reboot when upgrading firmware
    Web Admin: Show correct partition names in use under web "System -> Monitor" interface

Features:

    GNU utils: Busybox 1.14.2 patched.
    Device management: Busybox 1.14.2 mdev.
    Samba server: Samba 2.0.10 patched.
    FTP server: Vsftpd 2.2.0 patched.
    Disk Management: E2fsprogs 1.41.8.
    Print Server: p910nd 0.93. The printer processes are dinamically started/stopped when a printer is connected and disconnected.
    SFTP Daemon: OpenSSH sftp-server version 5.2p1
    SSH Daemon: Dropbear sshd version 0.52, with rsa and dss keys
    SCP Daemon: Dropbear scp version 0.52
    Telnet Daemon: Busybox 1.14.2 telnetd
    Torrent: Transmission daemon 1.73. Encryption and default web interface enabled.
    Web Server: Busybox 1.14.2 httpd
    Filesystems recognized: ext2, ext3, fat, vfat, ntfs, jffs2.
    NTP client: ntpclient 2007.
    DDNS client: inadyn 1.96.2. 
    Swap and Torrent automagically started when a disk with correct config is inserted (already had torrent/swap in use on it and the current configuration points to that location. When removal is detected, those services are stopped too.

Known Bugs/Issues:

Swapfile: It is NOT recommended to use swapfile on ntfs/vfat partitions, because of mounting and speed issues.
Recommended filesystems to use, in order (security): 1 - EXT3, 2 - EXT2, 3 - FAT32, 4 - NTFS.
Recommended filesystems to use, in order (speed): 1 - EXT2, 2 - VFAT, 3 - EXT3, 4 - NTFS.
Samba codepage issues with some eastern languages.
TODO:

    Filesystems: ext4 and RAID support.
    Servers: NFS support.
    Samba: Codepage support.

Installation:

    Both types of upgrade took up to 5 minutes in the tests. Don't reset or power off the device before this time.
    
    => FROM ORIGINAL FIRMWARE: USE "FROM-ORIGINAL" VERSION ONLY!!! <=

    The upgrade from the FUKBOON firmware can be done direct to the SNAKE OS beta 2, through it's web firmware upgrade page. 
    It's also possible to revert back to the original firmware in the same way later, if you wish ;-)


    => FROM SNAKE OS FIRMWARE: PREFER "FROM-SNAKE" VERSION. INFO: BOTH TYPES WILL WORK. <=

    In the SNAKE firmware, it will ask you to have a drive connected as sda1 for the update to work, also remember to have swapping on. 
        Apparently, in FUKBOON firmware a drive connected as C may be needed too.

    After installation, the device will reboot itself and revert back to the default settings:
            
    - Initial IP address: DHCP or 192.168.0.240 ( same as original firmware)
    - Web admin and Transmission user/password: admin/snake
    - SSH user/password: root/snake
    - After the first boot, the system will be slow for 1 to 3 minutes, because it is creating the initial SSH keys. Save the config (wich contains the SSH key) before rebooting and after the CPU gets low again, and this will not occur anymore. To do this, go to System->Config in web page.

Web admin:

    Access the device from your browser: http://<IP> or http://<IP>/index.html , where <IP> is initially 192.168.0.240 or another IP address, if you had changed it...

    Web admin sections:

        My NAS: General device status and reboot.

        Device->Hostname: Change system name.
        Device->Admin: Change administrative password.
        Device->LAN Settings: Manual or automatic IP Address settings. Manual MAC address management. When the device is flashed, the MAC will change.
        Device->Web Interface: Change default http port assignment for the administrative interface. Use with caution.
        Device->Time: Manual date/time setting or ntp config. It will try to connect every hour to keep time current. Remember to adjust your timezone here, too.

        Disks->Diskname: Disk naming option, it will recognize a disk "uuid+label" (will call it signature) and optionally specify a mount point with a custom name. It will ease with sharing setup, when the order that disks are mounted used to matter.
        Disks->Format: The format setting used will be ext3, with only one partition across the entire disk. It has be chosen because of performance and stability in tests. Note: If you wish a different partitioning, will have to format outside the device in the moment.
        Disks->Partition: To verify on which mount point one partition is/will be mounted. If you wish to properly disconnect a device, please umount it here first. A running service may avoid one partition to be umounted. Stop these services and try again, if possible. If a mounted partition use ext3/ext2 filesystem, error checking and correction options will be available.

        Services->DDNS: Manage the dynamic dns client service.
        Services->FTP: Manage the ftp sharing service and set permission mode.
        Services->Samba: Manage the file sharing service and set permission mode. All files will be owned by root on ext2/3 filesystems.
        Services->SFTP/SSHD: Manage the SFTP/SSH Daemon service and optionally regenerate the keys, if they where compromised, for example. Note: A new key is generated on the first device boot, so dealing with this will not be needed, generally.
        Services->Swapfile: Manage the Swapping service. ALWAYS USE IT.
        Services->Telnet: Manage the telnetd for remote access to shell of the NAS.
        Services->Transmission: Manage the BitTorrent service. Create your folder before setting it. The Transmission service will create a drop folder inside called "torrentwatch", where you can copy a .torrent file and the files will be automatically downloaded. Also possible to control startup and alternate transmission speed from here (will restart the service).
        Services->WebServer: Manage the additional NAS Web Server.

        Sharing->Printers: View of shared printers.
        Sharing->Shares: Manage shared samba folders.
        Sharing->Users: Manage users and passwords.

        System->Config: Save device config to file/flash or restore the default configuration.
        System->Status: General device status and reboot.
        System->Log: System message log.
        System->Monitor: Monitor CPU, memory and disk space usage.
        System->Firmware: Upgrade (or downgrade) your firmware. The process check the file integrity before write.

        About: People that have helped so far. Of course everyone with ideas is helping, but getting the hands dirty counts, too.

        Transmission: Link to Transmission web admin. As a separate process, will ask for login info again. Will default to http://<IP>:9091. When transmission saves config, it keeps the changes only in memory until transmission restart. You will need to save it, back to Services->Transmission, hit Apply and go to System->Config and Save.


Other considerations:

    As space permits only very stripped down packages, it's hard to beat Debian usability with just flash space.
    There are some other apps enabled in Busybox, like wget, top, tftp, ftpget, ftpput, etc. play with those too.
    A good streaming server would use too many resources. May work on it if sufficient interest or as a separate sub-project.
    To avoid internal space constraints, one possible approach is to use external "modules", containing software packages. It's on study for future versions.

Download:

    If you are already running SNAKE OS beta2 or later, prefer the from-snake version, otherwise, use the from-original version.

Grab it here: (Use Save as, if needed)

Compressed   (  3.4 MB) : snakeos-V1.0.0-20091027-from-original.zip md5sum inside

Compressed   (  3.4 MB) : snakeos-V1.0.0-20091027-from-snake.zip md5sum inside

User Manual  (  0.0 MB) : < Not yet, refer to beta3 manual meanwhile >.